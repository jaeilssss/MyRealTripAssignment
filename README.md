# π¨ νΈν…” μμ•½ μ„λΉ„μ¤ κ³Όμ 

λ™μ‹ μ ‘μ† ν™κ²½μ—μ„ κ°μ‹¤ μ¬κ³  κ΄€λ¦¬μ™€ μμ•½ λ¬΄κ²°μ„±μ„ μ•μ „ν•κ² μ²λ¦¬ν•λ” νΈν…” μμ•½ APIλ¥Ό κµ¬ν„ν–μµλ‹λ‹¤. **ν—¥μ‚¬κ³ λ‚  μ•„ν‚¤ν…μ²** κΈ°λ°μΌλ΅ μ„¤κ³„ν•μ—¬ λΉ„μ¦λ‹μ¤ λ΅μ§κ³Ό μΈν”„λΌ μμ΅΄μ„±μ„ λ¶„λ¦¬ν•κ³ , λ™μ‹μ„± λ¬Έμ λ¥Ό κ³ λ ¤ν• **μ¬κ³  μ°¨κ°/λ³µκµ¬ λ΅μ§**μ„ κµ¬ν„ν–μµλ‹λ‹¤.


**β€» μ‹κ°„ μ μ•½μΌλ΅ μΈν•΄ μµμ† κΈ°λ¥ μ¤‘μ‹¬μΌλ΅λ§ κµ¬ν„ν•μ€μΌλ©°, ν–¥ν›„ ν™•μ¥ λ° κ°μ„  κ°€λ¥μ„±μ„ κ³ λ ¤ν•μ—¬ μ„¤κ³„ν–μµλ‹λ‹¤.**


---

## π“ ν•µμ‹¬ κ°λ° λ©ν‘
* μ—¬λ¬ μ‚¬μ©μκ°€ λ™μ‹μ— μ ‘κ·Όν•΄λ„ μ΄κ³Ό μμ•½μ΄ λ°μƒν•μ§€ μ•λ„λ΅ μ¬κ³ λ¥Ό μ•μ „ν•κ² κ΄€λ¦¬
* μμ•½ μƒμ„±, μ΅°ν, μ·¨μ† API μ κ³µ
* Flywayλ¥Ό μ΄μ©ν• λ°μ΄ν„°λ² μ΄μ¤ λ§μ΄κ·Έλ μ΄μ… κ΄€λ¦¬
* ν—¥μ‚¬κ³ λ‚  μ•„ν‚¤ν…μ² κΈ°λ° κµ¬μ΅° μ„¤κ³„

---

## π§± μ£Όμ” κΈ°μ  μ¤νƒ
* **Language**: Kotlin
* **Framework**: Spring Boot
* **Persistence**: Spring Data JPA (Hibernate)
* **Migration**: Flyway
* **Database**: H2 (In-memory)

---


## π§© λ„λ©”μΈ λ¨λΈ

- **Hotel**: νΈν…” μ •λ³΄  
- **RoomType**: κ°μ‹¤ μ ν• (Standard, Deluxe λ“±)  
- **RoomInventory**: λ‚ μ§λ³„ κ°μ‹¤ μ¬κ³  κ΄€λ¦¬  
- **Guest**: μμ•½μ μ •λ³΄ (μλ™ μƒμ„±)  
- **Reservation**: μμ•½ μ •λ³΄  


---

## π— μ•„ν‚¤ν…μ² κµ¬μ΅° (Hexagonal Architecture)

λΉ„μ¦λ‹μ¤ λ΅μ§μ΄ μ™Έλ¶€ μΈν”„λΌ(DB, Web)μ— μμ΅΄ν•μ§€ μ•λ„λ΅ κ³„μΈµμ„ λ¶„λ¦¬ν–μµλ‹λ‹¤.

* **adapter/inbound**: API Controller
* **adapter/outbound**: Persistence Adapter (JPA κµ¬ν„μ²΄)
* **application/port**: μ„λΉ„μ¤ μΈν„°νμ΄μ¤ (Inbound/Outbound Port)
* **application/service**: ν•µμ‹¬ λΉ„μ¦λ‹μ¤ λ΅μ§
* **domain/entity**: λ„λ©”μΈ λ¨λΈ

---

## π” λ™μ‹μ„± μ²λ¦¬ μ „λµ
* **Pessimistic Lock**: μμ•½ μƒμ„± μ‹ λ‚ μ§λ³„ μ¬κ³ (`RoomInventory`)λ¥Ό **`PESSIMISTIC_WRITE`** λ¨λ“λ΅ μ΅°νν•μ—¬ λ™μ‹ μμ • μ°¨λ‹¨
* **Atomic Operation**: `availableRooms > 0` μ΅°κ±΄ ν™•μΈ ν›„ μ¦‰μ‹ μ°¨κ°
* **Transaction Management**: λ¨λ“  μμ•½/μ·¨μ† κ³Όμ •μ€ ν•λ‚μ νΈλμ­μ… λ‚΄μ—μ„ μ›μμ„± λ³΄μ¥

---

## β™οΈ λ°μ΄ν„°λ² μ΄μ¤ λ§μ΄κ·Έλ μ΄μ… (Flyway)
μ• ν”λ¦¬μΌ€μ΄μ… κµ¬λ™ μ‹ `src/main/resources/db/migration/`μ μ¤ν¬λ¦½νΈκ°€ μμ°¨μ μΌλ΅ μ‹¤ν–‰λ©λ‹λ‹¤.
* `V1__create_hotel.sql`
* `V2__create_room_type.sql`
* `V3__create_room_inventory.sql`
* `V4__create_guest.sql`
* `V5__create_reservation.sql`

---

## π€ λΉλ“ / μ‹¤ν–‰ λ°©λ²•
```bash
./gradlew bootRun
```
---



## μ•± κµ¬λ™ μ‹ μλ™μΌλ΅:

- νΈν…” 1κ° μƒμ„±
- λ£Ένƒ€μ… 2κ° μƒμ„± (Standard, Deluxe)
- ν–¥ν›„ 30μΌμΉ μ¬κ³  μλ™ μƒμ„±

λ³„λ„μ DB μ„Έν… μ—†μ΄ λ°”λ΅ ν…μ¤νΈ κ°€λ¥ν•©λ‹λ‹¤. 

*ν”„λ΅μ νΈ λ‚΄ DataInitializer ν΄λμ¤ μ°Έκ³ *

---

## π“΅ μ£Όμ” API λ©λ΅

### 1. λ£Ένƒ€μ…λ³„ μ¬κ³  μ΅°ν
- **GET** `/api/room-types/{roomTypeId}/inventory?date=YYYY-MM-DD`

### 2. μμ•½ μƒμ„± (κ²μ¤νΈ μλ™ μƒμ„±)
- **POST** `/api/reservations`
- **Request Body Example:**
```json
{
  "guestName": "ν™κΈΈλ™",
  "guestEmail": "hong@example.com",
  "guestPhone": "010-1234-5678",
  "roomTypeId": 1,
  "checkInDate": "2026-02-15",
  "checkOutDate": "2026-02-18"
}
```
### 3. μμ•½ μ΅°ν λ° μ·¨μ†
* **μ΅°ν**: `GET /api/reservations/{reservationId}`
* **μ·¨μ†**: `DELETE /api/reservations/{reservationId}`

---


## π§ ν…μ¤νΈ μ‹λ‚λ¦¬μ¤
* **μ •μƒ μμ•½**: μ”μ²­ μ‹ `200 OK` μ‘λ‹µ λ° `RoomInventory` μλ‰ 1 κ°μ† ν™•μΈ
* **λ™μ‹μ„± ν…μ¤νΈ**: λ™μΌ λ‚ μ§μ λ§μ§€λ§‰ λ‚¨μ€ 1μ‹¤μ— λ€ν•΄ λ™μ‹ μ”μ²­ μ‹ 1λ…λ§ μ„±κ³µ ν™•μΈ
* **μ¬κ³  λ¶€μ΅±**: μ¬κ³ κ°€ 0μΈ λ‚ μ§μ— μμ•½ μ‹λ„ μ‹ `400/409` μ—λ¬ λ°ν™
* **μμ•½ μ·¨μ†**: μ·¨μ† μ„±κ³µ μ‹ `204 No Content` λ° ν•΄λ‹Ή λ‚ μ§λ“¤ μ¬κ³  1 μ¦κ°€ ν™•μΈ

---

## π― κµ¬ν„ μ¤‘μ  μ‚¬ν•­
* **κ³„μΈµ λ¶„λ¦¬**: Serviceλ” Port(Interface)μ—λ§ μμ΅΄ν•μ—¬ μ μ—°μ„± ν™•λ³΄ λ° ν…μ¤νΈ μ©μ΄μ„± μ¦λ€
* **μλ™ν™”**: μ•± μ‹¤ν–‰ μ‹ νΈν…”/λ£Ένƒ€μ…/30μΌμΉ μ¬κ³  μλ™ μƒμ„±μΌλ΅ μ¦‰μ‹ ν…μ¤νΈ κ°€λ¥ ν™κ²½ κµ¬μ¶•
* **μ•μ •μ„±**: λ™μ‹ μ”μ²­ μƒν™©μ—μ„λ„ λΉ„κ΄€μ  λ½μ„ ν†µν•΄ λ°μ΄ν„° μ •ν•©μ„± μ™„λ²½ λ³΄μ¥
* **λ¬΄κ²°μ„±**: μμ•½ 1κ±΄λ‹Ή κ°μ‹¤ 1μ‹¤ κµ¬μ΅°λ΅ μ„¤κ³„ν•μ—¬ λ„λ©”μΈ λ¨λΈμ λ…ν™•μ„± ν™•λ³΄
